// Alternative Version for FreeBSD
// Activate and modify as needed, and replace witch config.cfg
// Needed:
// scmartctl, vnstat, mrtg

// lists all Stats you can get
list = [ "load", "mem" , "HDDusage" , "netTraf", "cpu" , "ssh", "mrtg"];


// Path to the json Files
// WITH trailing / IMPORTANT
path = "/usr/local/etc/fidistat/json/";

// How many Data Points should be saved and displayed by Statusboard
maxEntrys = 144;

// enabled:  should script check this Stat
// type:     
//       0:  Line Graph         (Shows values over Time)
//       1:  Bar Graph          (Shows One bar per item)
//       2:  CSV Table          (Shows Table of Data)
// cmmd:    command to get all data values
// regex:   Regular Expression which parses individual value for every datasequence
//          If Type = 2, output is not regexed, the regex value is used as Header for the Table
// display: These Items are parsed as Key Value Objects to JSON to initially create the .json file
// sequencetitles: Titles of every Datasequence in this stat. (See README and Statusboard Website

// CPU load
load =
{
    enabled = true;
    cmmd = "uptime | awk '{print $(NF-2)} {print$(NF-1)} {print $(NF)}'";
    regex = "[0-9]?[0-9].[0-9][0-9]";
    display = {
        title = "Load Averages",
        type = "line",
        refreshEveryNSeconds = 60,
        yAxis = { 
            minValue = 0,
            maxValue = 3
        }
    };
    sequencetitles = [ "1min", "5min", "15min" ];
}

// Memory Usage
mem =
{
    enabled = true;
    cmmd = "vmstat | tail -1 | awk '{print $4} {print $5}'";
    regex = "[0-9]+";
    display = {
        title = "Memory Usage",
        type = "line",
        refreshEveryNSeconds = 60
    };
    sequencetitles = [ "active", "free" ];

}

// Disk Usage
HDDusage = 
{
    enabled = false;
    cmmd = "df | grep -E \"zroot/data |zroot/usr/jails |zroot/ROOT/default \" | awk '{print $3}'";
    regex = "[0-9]+";
    display = {
        title = "Disk Usage",
        type = "bar",
        refreshEveryNSeconds = 60
    };
    sequencetitles = [ "SSD" ];
    bartitles = [ "/data", "/usr/jails", "/"];
}

// NetworkTraffic
netTraf =
{
    enabled = true;
    cmmd = "/usr/local/bin/vnstat -h | tail -2 | head -1 | awk '{print $8} {print $9}'";
    regex = "[0-9]+";
    display = {
        title = "Hourly Network Traffic",
        type = "line",
        refreshEveryNSeconds = 60
    };
    sequencetitles = [ "In", "Out" ];
}

// CPU Temperature
cpu =
{
    enabled = true;
    cmmd = "sysctl -a dev.cpu | grep temperature";
    regex = "[0-9][0-9]\\.[0-9]"
    display = {
        title = "CPU Temperature",
        type = "line",
        refreshEveryNSeconds = 60
    };
    sequencetitles = [ "CPU 1", "CPU 2", "CPU 3", "CPU 4" ];
}

// Parses mrtg Logfiles and displays Network Taffic 
mrtg =
{
    enabled = true;
    cmmd = "awk 'NR==2 {{print $2} {print $3}}' /data/www/mrtg/fritzbox.log"
    regex = "[0-9]+";
    display = {
        title = "Avg Router network Traffic",
        type = "line",
        refreshEveryNSeconds = 60
    };
    sequencetitles = [ "In", "Out" ];
}

// Table of last logins
ssh = 
{
    enabled = true;
    cmmd = "cat /var/log/auth.log | grep sshd | grep -v 'preauth' | grep -v 'disconnect' | awk ' {if ($7==\"Invalid\") print $6 \"; \" $10; else print $6 \"; \" $11;}' | tail -9 -r"
    display = {
        title = "State; IP";
        type = "csv"
    };
}
